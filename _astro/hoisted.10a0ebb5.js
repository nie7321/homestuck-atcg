const Et=i=>Object.prototype.toString.call(i)==="[object Object]",K=(i,t)=>{const e=document.createElement(i);if(t&&typeof t=="object")for(const s in t)s==="html"?e.innerHTML=t[s]:e.setAttribute(s,t[s]);return e},at=i=>["#text","#comment"].includes(i.nodeName)?i.data:i.childNodes?i.childNodes.map(t=>at(t)).join(""):"",vt=function(i,t){let e=0,s=0;for(;e<i+1;)t[s].hidden||(e+=1),s+=1;return s-1};function ut(i,t,e){var s;return i.nodeName==="#text"?s=e.document.createTextNode(i.data):i.nodeName==="#comment"?s=e.document.createComment(i.data):(t?s=e.document.createElementNS("http://www.w3.org/2000/svg",i.nodeName):i.nodeName.toLowerCase()==="svg"?(s=e.document.createElementNS("http://www.w3.org/2000/svg","svg"),t=!0):s=e.document.createElement(i.nodeName),i.attributes&&Object.entries(i.attributes).forEach(function(n){var o=n[0],a=n[1];return s.setAttribute(o,a)}),i.childNodes&&i.childNodes.forEach(function(n){return s.appendChild(ut(n,t,e))}),e.valueDiffing&&(i.value&&(s instanceof HTMLButtonElement||s instanceof HTMLDataElement||s instanceof HTMLInputElement||s instanceof HTMLLIElement||s instanceof HTMLMeterElement||s instanceof HTMLOptionElement||s instanceof HTMLProgressElement||s instanceof HTMLParamElement)&&(s.value=i.value),i.checked&&s instanceof HTMLInputElement&&(s.checked=i.checked),i.selected&&s instanceof HTMLOptionElement&&(s.selected=i.selected))),s}var dt=function(i,t){for(t=t.slice();t.length>0;){var e=t.splice(0,1)[0];i=i.childNodes[e]}return i};function z(i,t,e){var s,n,o,a=t[e._const.action],r=t[e._const.route];[e._const.addElement,e._const.addTextElement].includes(a)||(s=dt(i,r));var l={diff:t,node:s};if(e.preDiffApply(l))return!0;switch(a){case e._const.addAttribute:if(!(s&&s instanceof Element))return!1;s.setAttribute(t[e._const.name],t[e._const.value]);break;case e._const.modifyAttribute:if(!(s&&s instanceof Element))return!1;s.setAttribute(t[e._const.name],t[e._const.newValue]),s instanceof HTMLInputElement&&t[e._const.name]==="value"&&(s.value=t[e._const.newValue]);break;case e._const.removeAttribute:if(!(s&&s instanceof Element))return!1;s.removeAttribute(t[e._const.name]);break;case e._const.modifyTextElement:if(!(s&&s instanceof Text))return!1;e.textDiff(s,s.data,t[e._const.oldValue],t[e._const.newValue]),s.parentNode instanceof HTMLTextAreaElement&&(s.parentNode.value=t[e._const.newValue]);break;case e._const.modifyValue:if(!s||s.value===void 0)return!1;s.value=t[e._const.newValue];break;case e._const.modifyComment:if(!(s&&s instanceof Comment))return!1;e.textDiff(s,s.data,t[e._const.oldValue],t[e._const.newValue]);break;case e._const.modifyChecked:if(!s||s.checked===void 0)return!1;s.checked=t[e._const.newValue];break;case e._const.modifySelected:if(!s||s.selected===void 0)return!1;s.selected=t[e._const.newValue];break;case e._const.replaceElement:var d=t[e._const.newValue].nodeName.toLowerCase()==="svg"||s.parentNode.namespaceURI==="http://www.w3.org/2000/svg";s.parentNode.replaceChild(ut(t[e._const.newValue],d,e),s);break;case e._const.relocateGroup:Array.apply(void 0,new Array(t[e._const.groupLength])).map(function(){return s.removeChild(s.childNodes[t[e._const.from]])}).forEach(function(h,u){u===0&&(o=s.childNodes[t[e._const.to]]),s.insertBefore(h,o||null)});break;case e._const.removeElement:s.parentNode.removeChild(s);break;case e._const.addElement:var m=(g=r.slice()).splice(g.length-1,1)[0];if(!((s=dt(i,g))instanceof Element))return!1;s.insertBefore(ut(t[e._const.element],s.namespaceURI==="http://www.w3.org/2000/svg",e),s.childNodes[m]||null);break;case e._const.removeTextElement:if(!s||s.nodeType!==3)return!1;var b=s.parentNode;b.removeChild(s),b instanceof HTMLTextAreaElement&&(b.value="");break;case e._const.addTextElement:var g;if(m=(g=r.slice()).splice(g.length-1,1)[0],n=e.document.createTextNode(t[e._const.value]),!(s=dt(i,g)).childNodes)return!1;s.insertBefore(n,s.childNodes[m]||null),s.parentNode instanceof HTMLTextAreaElement&&(s.parentNode.value=t[e._const.value]);break;default:console.log("unknown action")}return e.postDiffApply({diff:l.diff,node:l.node,newNode:n}),!0}function ct(i,t,e){var s=i[t];i[t]=i[e],i[e]=s}function $t(i,t,e){(t=t.slice()).reverse(),t.forEach(function(s){(function(n,o,a){switch(o[a._const.action]){case a._const.addAttribute:o[a._const.action]=a._const.removeAttribute,z(n,o,a);break;case a._const.modifyAttribute:ct(o,a._const.oldValue,a._const.newValue),z(n,o,a);break;case a._const.removeAttribute:o[a._const.action]=a._const.addAttribute,z(n,o,a);break;case a._const.modifyTextElement:case a._const.modifyValue:case a._const.modifyComment:case a._const.modifyChecked:case a._const.modifySelected:case a._const.replaceElement:ct(o,a._const.oldValue,a._const.newValue),z(n,o,a);break;case a._const.relocateGroup:ct(o,a._const.from,a._const.to),z(n,o,a);break;case a._const.removeElement:o[a._const.action]=a._const.addElement,z(n,o,a);break;case a._const.addElement:o[a._const.action]=a._const.removeElement,z(n,o,a);break;case a._const.removeTextElement:o[a._const.action]=a._const.addTextElement,z(n,o,a);break;case a._const.addTextElement:o[a._const.action]=a._const.removeTextElement,z(n,o,a);break;default:console.log("unknown action")}})(i,s,e)})}var pt=function(i){var t=[];return t.push(i.nodeName),i.nodeName!=="#text"&&i.nodeName!=="#comment"&&i.attributes&&(i.attributes.class&&t.push("".concat(i.nodeName,".").concat(i.attributes.class.replace(/ /g,"."))),i.attributes.id&&t.push("".concat(i.nodeName,"#").concat(i.attributes.id))),t},yt=function(i){var t={},e={};return i.forEach(function(s){pt(s).forEach(function(n){var o=n in t;o||n in e?o&&(delete t[n],e[n]=!0):t[n]=!0})}),t},Vt=function(i,t){var e=yt(i),s=yt(t),n={};return Object.keys(e).forEach(function(o){s[o]&&(n[o]=!0)}),n},xt=function(i){return delete i.outerDone,delete i.innerDone,delete i.valueDone,!i.childNodes||i.childNodes.every(xt)},R=function(i){if(Object.prototype.hasOwnProperty.call(i,"data"))return{nodeName:i.nodeName==="#text"?"#text":"#comment",data:i.data};var t={nodeName:i.nodeName};return Object.prototype.hasOwnProperty.call(i,"attributes")&&(t.attributes=i.attributes),Object.prototype.hasOwnProperty.call(i,"checked")&&(t.checked=i.checked),Object.prototype.hasOwnProperty.call(i,"value")&&(t.value=i.value),Object.prototype.hasOwnProperty.call(i,"selected")&&(t.selected=i.selected),Object.prototype.hasOwnProperty.call(i,"childNodes")&&(t.childNodes=i.childNodes.map(function(e){return R(e)})),t},ft=function(i,t){if(!["nodeName","value","checked","selected","data"].every(function(n){return i[n]===t[n]}))return!1;if(Object.prototype.hasOwnProperty.call(i,"data"))return!0;if(!!i.attributes!=!!t.attributes||!!i.childNodes!=!!t.childNodes)return!1;if(i.attributes){var e=Object.keys(i.attributes),s=Object.keys(t.attributes);if(e.length!==s.length||!e.every(function(n){return i.attributes[n]===t.attributes[n]}))return!1}return!(i.childNodes&&(i.childNodes.length!==t.childNodes.length||!i.childNodes.every(function(n,o){return ft(n,t.childNodes[o])})))},bt=function(i,t,e,s,n){if(n===void 0&&(n=!1),!i||!t||i.nodeName!==t.nodeName)return!1;if(["#text","#comment"].includes(i.nodeName))return!!n||i.data===t.data;if(i.nodeName in e)return!0;if(i.attributes&&t.attributes){if(i.attributes.id){if(i.attributes.id!==t.attributes.id)return!1;if("".concat(i.nodeName,"#").concat(i.attributes.id)in e)return!0}if(i.attributes.class&&i.attributes.class===t.attributes.class&&"".concat(i.nodeName,".").concat(i.attributes.class.replace(/ /g,"."))in e)return!0}if(s)return!0;var o=i.childNodes?i.childNodes.slice().reverse():[],a=t.childNodes?t.childNodes.slice().reverse():[];if(o.length!==a.length)return!1;if(n)return o.every(function(l,d){return l.nodeName===a[d].nodeName});var r=Vt(o,a);return o.every(function(l,d){return bt(l,a[d],r,!0,!0)})},it=function(i,t){return Array.apply(void 0,new Array(i)).map(function(){return t})},Tt=function(i,t){for(var e=i.childNodes?i.childNodes:[],s=t.childNodes?t.childNodes:[],n=it(e.length,!1),o=it(s.length,!1),a=[],r=function(){return arguments[1]},l=!1,d=function(){var m=function(b,g,h,u){var y=0,D=[],v=b.length,c=g.length,M=Array.apply(void 0,new Array(v+1)).map(function(){return[]}),$=Vt(b,g),T=v===c;T&&b.some(function(A,N){var f=pt(A),p=pt(g[N]);return f.length!==p.length?(T=!1,!0):(f.some(function(x,_){if(x!==p[_])return T=!1,!0}),!T||void 0)});for(var S=0;S<v;S++)for(var E=b[S],w=0;w<c;w++){var k=g[w];h[S]||u[w]||!bt(E,k,$,T)?M[S+1][w+1]=0:(M[S+1][w+1]=M[S][w]?M[S][w]+1:1,M[S+1][w+1]>=y&&(y=M[S+1][w+1],D=[S+1,w+1]))}return y!==0&&{oldValue:D[0]-y,newValue:D[1]-y,length:y}}(e,s,n,o);m?(a.push(m),Array.apply(void 0,new Array(m.length)).map(r).forEach(function(b){return function(g,h,u,y){g[u.oldValue+y]=!0,h[u.newValue+y]=!0}(n,o,m,b)})):l=!0};!l;)d();return i.subsets=a,i.subsetsAge=100,a},St=function(){function i(){this.list=[]}return i.prototype.add=function(t){var e;(e=this.list).push.apply(e,t)},i.prototype.forEach=function(t){this.list.forEach(function(e){return t(e)})},i}(),H=function(){function i(t){t===void 0&&(t={});var e=this;Object.entries(t).forEach(function(s){var n=s[0],o=s[1];return e[n]=o})}return i.prototype.toString=function(){return JSON.stringify(this)},i.prototype.setValue=function(t,e){return this[t]=e,this},i}();function ht(i,t){var e,s,n=i;for(t=t.slice();t.length>0;)s=t.splice(0,1)[0],e=n,n=n.childNodes?n.childNodes[s]:void 0;return{node:n,parentNode:e,nodeIndex:s}}function Lt(i,t,e){return t.forEach(function(s){(function(n,o,a){var r,l,d,m;if(![a._const.addElement,a._const.addTextElement].includes(o[a._const.action])){var b=ht(n,o[a._const.route]);l=b.node,d=b.parentNode,m=b.nodeIndex}var g,h,u=[],y={diff:o,node:l};if(a.preVirtualDiffApply(y))return!0;switch(o[a._const.action]){case a._const.addAttribute:l.attributes||(l.attributes={}),l.attributes[o[a._const.name]]=o[a._const.value],o[a._const.name]==="checked"?l.checked=!0:o[a._const.name]==="selected"?l.selected=!0:l.nodeName==="INPUT"&&o[a._const.name]==="value"&&(l.value=o[a._const.value]);break;case a._const.modifyAttribute:l.attributes[o[a._const.name]]=o[a._const.newValue];break;case a._const.removeAttribute:delete l.attributes[o[a._const.name]],Object.keys(l.attributes).length===0&&delete l.attributes,o[a._const.name]==="checked"?l.checked=!1:o[a._const.name]==="selected"?delete l.selected:l.nodeName==="INPUT"&&o[a._const.name]==="value"&&delete l.value;break;case a._const.modifyTextElement:l.data=o[a._const.newValue],d.nodeName==="TEXTAREA"&&(d.value=o[a._const.newValue]);break;case a._const.modifyValue:l.value=o[a._const.newValue];break;case a._const.modifyComment:l.data=o[a._const.newValue];break;case a._const.modifyChecked:l.checked=o[a._const.newValue];break;case a._const.modifySelected:l.selected=o[a._const.newValue];break;case a._const.replaceElement:g=o[a._const.newValue],d.childNodes[m]=g;break;case a._const.relocateGroup:l.childNodes.splice(o[a._const.from],o[a._const.groupLength]).reverse().forEach(function(c){return l.childNodes.splice(o[a._const.to],0,c)}),l.subsets&&l.subsets.forEach(function(c){if(o[a._const.from]<o[a._const.to]&&c.oldValue<=o[a._const.to]&&c.oldValue>o[a._const.from])c.oldValue-=o[a._const.groupLength],(M=c.oldValue+c.length-o[a._const.to])>0&&(u.push({oldValue:o[a._const.to]+o[a._const.groupLength],newValue:c.newValue+c.length-M,length:M}),c.length-=M);else if(o[a._const.from]>o[a._const.to]&&c.oldValue>o[a._const.to]&&c.oldValue<o[a._const.from]){var M;c.oldValue+=o[a._const.groupLength],(M=c.oldValue+c.length-o[a._const.to])>0&&(u.push({oldValue:o[a._const.to]+o[a._const.groupLength],newValue:c.newValue+c.length-M,length:M}),c.length-=M)}else c.oldValue===o[a._const.from]&&(c.oldValue=o[a._const.to])});break;case a._const.removeElement:d.childNodes.splice(m,1),d.subsets&&d.subsets.forEach(function(c){c.oldValue>m?c.oldValue-=1:c.oldValue===m?c.delete=!0:c.oldValue<m&&c.oldValue+c.length>m&&(c.oldValue+c.length-1===m?c.length--:(u.push({newValue:c.newValue+m-c.oldValue,oldValue:m,length:c.length-m+c.oldValue-1}),c.length=m-c.oldValue))}),l=d;break;case a._const.addElement:var D=(h=o[a._const.route].slice()).splice(h.length-1,1)[0];l=(r=ht(n,h))===null||r===void 0?void 0:r.node,g=o[a._const.element],l.childNodes||(l.childNodes=[]),D>=l.childNodes.length?l.childNodes.push(g):l.childNodes.splice(D,0,g),l.subsets&&l.subsets.forEach(function(c){if(c.oldValue>=D)c.oldValue+=1;else if(c.oldValue<D&&c.oldValue+c.length>D){var M=c.oldValue+c.length-D;u.push({newValue:c.newValue+c.length-M,oldValue:D+1,length:M}),c.length-=M}});break;case a._const.removeTextElement:d.childNodes.splice(m,1),d.nodeName==="TEXTAREA"&&delete d.value,d.subsets&&d.subsets.forEach(function(c){c.oldValue>m?c.oldValue-=1:c.oldValue===m?c.delete=!0:c.oldValue<m&&c.oldValue+c.length>m&&(c.oldValue+c.length-1===m?c.length--:(u.push({newValue:c.newValue+m-c.oldValue,oldValue:m,length:c.length-m+c.oldValue-1}),c.length=m-c.oldValue))}),l=d;break;case a._const.addTextElement:var v=(h=o[a._const.route].slice()).splice(h.length-1,1)[0];(g={}).nodeName="#text",g.data=o[a._const.value],(l=ht(n,h).node).childNodes||(l.childNodes=[]),v>=l.childNodes.length?l.childNodes.push(g):l.childNodes.splice(v,0,g),l.nodeName==="TEXTAREA"&&(l.value=o[a._const.newValue]),l.subsets&&l.subsets.forEach(function(c){if(c.oldValue>=v&&(c.oldValue+=1),c.oldValue<v&&c.oldValue+c.length>v){var M=c.oldValue+c.length-v;u.push({newValue:c.newValue+c.length-M,oldValue:v+1,length:M}),c.length-=M}});break;default:console.log("unknown action")}l.subsets&&(l.subsets=l.subsets.filter(function(c){return!c.delete&&c.oldValue!==c.newValue}),u.length&&(l.subsets=l.subsets.concat(u))),a.postVirtualDiffApply({node:y.node,diff:y.diff,newNode:g})})(i,s,e)}),!0}function Q(i,t){t===void 0&&(t={valueDiffing:!0});var e={nodeName:i.nodeName};return i instanceof Text||i instanceof Comment?e.data=i.data:(i.attributes&&i.attributes.length>0&&(e.attributes={},Array.prototype.slice.call(i.attributes).forEach(function(s){return e.attributes[s.name]=s.value})),i.childNodes&&i.childNodes.length>0&&(e.childNodes=[],Array.prototype.slice.call(i.childNodes).forEach(function(s){return e.childNodes.push(Q(s,t))})),t.valueDiffing&&(i instanceof HTMLTextAreaElement&&(e.value=i.value),i instanceof HTMLInputElement&&["radio","checkbox"].includes(i.type.toLowerCase())&&i.checked!==void 0?e.checked=i.checked:(i instanceof HTMLButtonElement||i instanceof HTMLDataElement||i instanceof HTMLInputElement||i instanceof HTMLLIElement||i instanceof HTMLMeterElement||i instanceof HTMLOptionElement||i instanceof HTMLProgressElement||i instanceof HTMLParamElement)&&(e.value=i.value),i instanceof HTMLOptionElement&&(e.selected=i.selected))),e}var At=/<\s*\/*[a-zA-Z:_][a-zA-Z0-9:_\-.]*\s*(?:"[^"]*"['"]*|'[^']*'['"]*|[^'"/>])*\/*\s*>|<!--(?:.|\n|\r)*?-->/g,kt=/\s([^'"/\s><]+?)[\s/>]|([^\s=]+)=\s?(".*?"|'.*?')/g;function wt(i){return i.replace(/&lt;/g,"<").replace(/&gt;/g,">").replace(/&amp;/g,"&")}var Pt={area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,menuItem:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0},Nt=function(i){var t={nodeName:"",attributes:{}},e=!1,s=i.match(/<\/?([^\s]+?)[/\s>]/);if(s&&(t.nodeName=s[1],(Pt[s[1]]||i.charAt(i.length-2)==="/")&&(e=!0),t.nodeName.startsWith("!--"))){var n=i.indexOf("-->");return{type:"comment",node:{nodeName:"#comment",data:n!==-1?i.slice(4,n):""},voidElement:e}}for(var o=new RegExp(kt),a=null,r=!1;!r;)if((a=o.exec(i))===null)r=!0;else if(a[0].trim())if(a[1]){var l=a[1].trim(),d=[l,""];l.indexOf("=")>-1&&(d=l.split("=")),t.attributes[d[0]]=d[1],o.lastIndex--}else a[2]&&(t.attributes[a[2]]=a[3].trim().substring(1,a[3].length-1));return{type:"tag",node:t,voidElement:e}},Z=function(i,t){t===void 0&&(t={valueDiffing:!0});var e,s=[],n=-1,o=[];if(i.indexOf("<")!==0){var a=i.indexOf("<");s.push({nodeName:"#text",data:a===-1?i:i.substring(0,a)})}return i.replace(At,function(r,l){var d=r.charAt(1)!=="/",m=r.startsWith("<!--"),b=l+r.length,g=i.charAt(b);if(m){var h=Nt(r).node;if(n<0)return s.push(h),"";var u=o[n];return u&&h.nodeName&&(u.node.childNodes||(u.node.childNodes=[]),u.node.childNodes.push(h)),""}if(d){if(e=Nt(r),n++,!e.voidElement&&g&&g!=="<"){e.node.childNodes||(e.node.childNodes=[]);var y=wt(i.slice(b,i.indexOf("<",b)));e.node.childNodes.push({nodeName:"#text",data:y}),t.valueDiffing&&e.node.nodeName==="TEXTAREA"&&(e.node.value=y)}n===0&&e.node.nodeName&&s.push(e.node);var D=o[n-1];D&&e.node.nodeName&&(D.node.childNodes||(D.node.childNodes=[]),D.node.childNodes.push(e.node)),o[n]=e}if((!d||e.voidElement)&&(n>-1&&(e.voidElement||e.node.nodeName.toUpperCase()===r.slice(2,-1).toUpperCase())&&--n>-1&&(e=o[n]),g!=="<"&&g)){var v=n===-1?s:o[n].node.childNodes||[],c=i.indexOf("<",b);y=wt(i.slice(b,c===-1?void 0:c)),v.push({nodeName:"#text",data:y})}return""}),s[0]},Ct=function(){function i(t,e,s){this.options=s,this.t1=typeof Element<"u"&&t instanceof Element?Q(t,this.options):typeof t=="string"?Z(t,this.options):JSON.parse(JSON.stringify(t)),this.t2=typeof Element<"u"&&e instanceof Element?Q(e,this.options):typeof e=="string"?Z(e,this.options):JSON.parse(JSON.stringify(e)),this.diffcount=0,this.foundAll=!1,this.debug&&(this.t1Orig=typeof Element<"u"&&t instanceof Element?Q(t,this.options):typeof t=="string"?Z(t,this.options):JSON.parse(JSON.stringify(t)),this.t2Orig=typeof Element<"u"&&e instanceof Element?Q(e,this.options):typeof e=="string"?Z(e,this.options):JSON.parse(JSON.stringify(e))),this.tracker=new St}return i.prototype.init=function(){return this.findDiffs(this.t1,this.t2)},i.prototype.findDiffs=function(t,e){var s;do{if(this.options.debug&&(this.diffcount+=1,this.diffcount>this.options.diffcap))throw new Error("surpassed diffcap:".concat(JSON.stringify(this.t1Orig)," -> ").concat(JSON.stringify(this.t2Orig)));(s=this.findNextDiff(t,e,[])).length===0&&(ft(t,e)||(this.foundAll?console.error("Could not find remaining diffs!"):(this.foundAll=!0,xt(t),s=this.findNextDiff(t,e,[])))),s.length>0&&(this.foundAll=!1,this.tracker.add(s),Lt(t,s,this.options))}while(s.length>0);return this.tracker.list},i.prototype.findNextDiff=function(t,e,s){var n,o;if(this.options.maxDepth&&s.length>this.options.maxDepth)return[];if(!t.outerDone){if(n=this.findOuterDiff(t,e,s),this.options.filterOuterDiff&&(o=this.options.filterOuterDiff(t,e,n))&&(n=o),n.length>0)return t.outerDone=!0,n;t.outerDone=!0}if(Object.prototype.hasOwnProperty.call(t,"data"))return[];if(!t.innerDone){if((n=this.findInnerDiff(t,e,s)).length>0)return n;t.innerDone=!0}if(this.options.valueDiffing&&!t.valueDone){if((n=this.findValueDiff(t,e,s)).length>0)return t.valueDone=!0,n;t.valueDone=!0}return[]},i.prototype.findOuterDiff=function(t,e,s){var n,o,a,r,l,d,m=[];if(t.nodeName!==e.nodeName){if(!s.length)throw new Error("Top level nodes have to be of the same kind.");return[new H().setValue(this.options._const.action,this.options._const.replaceElement).setValue(this.options._const.oldValue,R(t)).setValue(this.options._const.newValue,R(e)).setValue(this.options._const.route,s)]}if(s.length&&this.options.diffcap<Math.abs((t.childNodes||[]).length-(e.childNodes||[]).length))return[new H().setValue(this.options._const.action,this.options._const.replaceElement).setValue(this.options._const.oldValue,R(t)).setValue(this.options._const.newValue,R(e)).setValue(this.options._const.route,s)];if(Object.prototype.hasOwnProperty.call(t,"data")&&t.data!==e.data)return t.nodeName==="#text"?[new H().setValue(this.options._const.action,this.options._const.modifyTextElement).setValue(this.options._const.route,s).setValue(this.options._const.oldValue,t.data).setValue(this.options._const.newValue,e.data)]:[new H().setValue(this.options._const.action,this.options._const.modifyComment).setValue(this.options._const.route,s).setValue(this.options._const.oldValue,t.data).setValue(this.options._const.newValue,e.data)];for(o=t.attributes?Object.keys(t.attributes).sort():[],a=e.attributes?Object.keys(e.attributes).sort():[],r=o.length,d=0;d<r;d++)n=o[d],(l=a.indexOf(n))===-1?m.push(new H().setValue(this.options._const.action,this.options._const.removeAttribute).setValue(this.options._const.route,s).setValue(this.options._const.name,n).setValue(this.options._const.value,t.attributes[n])):(a.splice(l,1),t.attributes[n]!==e.attributes[n]&&m.push(new H().setValue(this.options._const.action,this.options._const.modifyAttribute).setValue(this.options._const.route,s).setValue(this.options._const.name,n).setValue(this.options._const.oldValue,t.attributes[n]).setValue(this.options._const.newValue,e.attributes[n])));for(r=a.length,d=0;d<r;d++)n=a[d],m.push(new H().setValue(this.options._const.action,this.options._const.addAttribute).setValue(this.options._const.route,s).setValue(this.options._const.name,n).setValue(this.options._const.value,e.attributes[n]));return m},i.prototype.findInnerDiff=function(t,e,s){var n=t.childNodes?t.childNodes.slice():[],o=e.childNodes?e.childNodes.slice():[],a=Math.max(n.length,o.length),r=Math.abs(n.length-o.length),l=[],d=0;if(!this.options.maxChildCount||a<this.options.maxChildCount){var m=!!(t.subsets&&t.subsetsAge--),b=m?t.subsets:t.childNodes&&e.childNodes?Tt(t,e):[];if(b.length>0&&(l=this.attemptGroupRelocation(t,e,b,s,m)).length>0)return l}for(var g=0;g<a;g+=1){var h=n[g],u=o[g];if(r&&(h&&!u?h.nodeName==="#text"?(l.push(new H().setValue(this.options._const.action,this.options._const.removeTextElement).setValue(this.options._const.route,s.concat(d)).setValue(this.options._const.value,h.data)),d-=1):(l.push(new H().setValue(this.options._const.action,this.options._const.removeElement).setValue(this.options._const.route,s.concat(d)).setValue(this.options._const.element,R(h))),d-=1):u&&!h&&(u.nodeName==="#text"?l.push(new H().setValue(this.options._const.action,this.options._const.addTextElement).setValue(this.options._const.route,s.concat(d)).setValue(this.options._const.value,u.data)):l.push(new H().setValue(this.options._const.action,this.options._const.addElement).setValue(this.options._const.route,s.concat(d)).setValue(this.options._const.element,R(u))))),h&&u){if(!this.options.maxChildCount||a<this.options.maxChildCount)l=l.concat(this.findNextDiff(h,u,s.concat(d)));else if(!ft(h,u))if(n.length>o.length)h.nodeName==="#text"?l.push(new H().setValue(this.options._const.action,this.options._const.removeTextElement).setValue(this.options._const.route,s.concat(d)).setValue(this.options._const.value,h.data)):l.push(new H().setValue(this.options._const.action,this.options._const.removeElement).setValue(this.options._const.element,R(h)).setValue(this.options._const.route,s.concat(d))),n.splice(g,1),g-=1,d-=1,r-=1;else if(n.length<o.length){var y=R(u);l=l.concat([new H().setValue(this.options._const.action,this.options._const.addElement).setValue(this.options._const.element,y).setValue(this.options._const.route,s.concat(d))]),n.splice(g,0,y),r-=1}else l=l.concat([new H().setValue(this.options._const.action,this.options._const.replaceElement).setValue(this.options._const.oldValue,R(h)).setValue(this.options._const.newValue,R(u)).setValue(this.options._const.route,s.concat(d))])}d+=1}return t.innerDone=!0,l},i.prototype.attemptGroupRelocation=function(t,e,s,n,o){for(var a,r,l,d,m,b,g=function($,T,S){var E=$.childNodes?it($.childNodes.length,!0):[],w=T.childNodes?it(T.childNodes.length,!0):[],k=0;return S.forEach(function(A){for(var N=A.oldValue+A.length,f=A.newValue+A.length,p=A.oldValue;p<N;p+=1)E[p]=k;for(p=A.newValue;p<f;p+=1)w[p]=k;k+=1}),{gaps1:E,gaps2:w}}(t,e,s),h=g.gaps1,u=g.gaps2,y=Math.min(h.length,u.length),D=[],v=0,c=0;v<y;c+=1,v+=1)if(!o||h[v]!==!0&&u[v]!==!0){if(h[v]===!0)if((d=t.childNodes[c]).nodeName==="#text")if(e.childNodes[v].nodeName==="#text"){if(d.data!==e.childNodes[v].data){for(b=c;t.childNodes.length>b+1&&t.childNodes[b+1].nodeName==="#text";)if(b+=1,e.childNodes[v].data===t.childNodes[b].data){m=!0;break}if(!m)return D.push(new H().setValue(this.options._const.action,this.options._const.modifyTextElement).setValue(this.options._const.route,n.concat(v)).setValue(this.options._const.oldValue,d.data).setValue(this.options._const.newValue,e.childNodes[v].data)),D}}else D.push(new H().setValue(this.options._const.action,this.options._const.removeTextElement).setValue(this.options._const.route,n.concat(v)).setValue(this.options._const.value,d.data)),h.splice(v,1),y=Math.min(h.length,u.length),v-=1;else D.push(new H().setValue(this.options._const.action,this.options._const.removeElement).setValue(this.options._const.route,n.concat(v)).setValue(this.options._const.element,R(d))),h.splice(v,1),y=Math.min(h.length,u.length),v-=1;else if(u[v]===!0)(d=e.childNodes[v]).nodeName==="#text"?(D.push(new H().setValue(this.options._const.action,this.options._const.addTextElement).setValue(this.options._const.route,n.concat(v)).setValue(this.options._const.value,d.data)),h.splice(v,0,!0),y=Math.min(h.length,u.length),c-=1):(D.push(new H().setValue(this.options._const.action,this.options._const.addElement).setValue(this.options._const.route,n.concat(v)).setValue(this.options._const.element,R(d))),h.splice(v,0,!0),y=Math.min(h.length,u.length),c-=1);else if(h[v]!==u[v]){if(D.length>0)return D;if(l=s[h[v]],(r=Math.min(l.newValue,t.childNodes.length-l.length))!==l.oldValue){a=!1;for(var M=0;M<l.length;M+=1)bt(t.childNodes[r+M],t.childNodes[l.oldValue+M],{},!1,!0)||(a=!0);if(a)return[new H().setValue(this.options._const.action,this.options._const.relocateGroup).setValue(this.options._const.groupLength,l.length).setValue(this.options._const.from,l.oldValue).setValue(this.options._const.to,r).setValue(this.options._const.route,n)]}}}return D},i.prototype.findValueDiff=function(t,e,s){var n=[];return t.selected!==e.selected&&n.push(new H().setValue(this.options._const.action,this.options._const.modifySelected).setValue(this.options._const.oldValue,t.selected).setValue(this.options._const.newValue,e.selected).setValue(this.options._const.route,s)),(t.value||e.value)&&t.value!==e.value&&t.nodeName!=="OPTION"&&n.push(new H().setValue(this.options._const.action,this.options._const.modifyValue).setValue(this.options._const.oldValue,t.value||"").setValue(this.options._const.newValue,e.value||"").setValue(this.options._const.route,s)),t.checked!==e.checked&&n.push(new H().setValue(this.options._const.action,this.options._const.modifyChecked).setValue(this.options._const.oldValue,t.checked).setValue(this.options._const.newValue,e.checked).setValue(this.options._const.route,s)),n},i}(),Ht={debug:!1,diffcap:10,maxDepth:!1,maxChildCount:50,valueDiffing:!0,textDiff:function(i,t,e,s){i.data=s},preVirtualDiffApply:function(){},postVirtualDiffApply:function(){},preDiffApply:function(){},postDiffApply:function(){},filterOuterDiff:null,compress:!1,_const:!1,document:!(typeof window>"u"||!window.document)&&window.document,components:[]},Yt=function(){function i(t){if(t===void 0&&(t={}),Object.entries(Ht).forEach(function(n){var o=n[0],a=n[1];Object.prototype.hasOwnProperty.call(t,o)||(t[o]=a)}),!t._const){var e=["addAttribute","modifyAttribute","removeAttribute","modifyTextElement","relocateGroup","removeElement","addElement","removeTextElement","addTextElement","replaceElement","modifyValue","modifyChecked","modifySelected","modifyComment","action","route","oldValue","newValue","element","group","groupLength","from","to","name","value","data","attributes","nodeName","childNodes","checked","selected"],s={};t.compress?e.forEach(function(n,o){return s[n]=o}):e.forEach(function(n){return s[n]=n}),t._const=s}this.options=t}return i.prototype.apply=function(t,e){return function(s,n,o){return n.every(function(a){return z(s,a,o)})}(t,e,this.options)},i.prototype.undo=function(t,e){return $t(t,e,this.options)},i.prototype.diff=function(t,e){return new Ct(t,e,this.options).init()},i}();const mt=(i,t,e,{classes:s,format:n,hiddenHeader:o,sortable:a,scrollY:r,type:l},{noColumnWidths:d,unhideHeader:m})=>({nodeName:"TR",childNodes:i.map((b,g)=>{const h=t[g]||{type:l,format:n,sortable:!0,searchable:!0};if(h.hidden)return;const u={};if(h.sortable&&a&&(!r.length||m)&&(h.filter?u["data-filterable"]="true":u["data-sortable"]="true"),h.headerClass&&(u.class=h.headerClass),e.sort&&e.sort.column===g){const v=e.sort.dir==="asc"?s.ascending:s.descending;u.class=u.class?`${u.class} ${v}`:v,u["aria-sort"]=e.sort.dir==="asc"?"ascending":"descending"}else e.filters[g]&&(u.class=u.class?`${u.class} ${s.filterActive}`:s.filterActive);let y="";e.widths[g]&&!d&&(y+=`width: ${e.widths[g]}%;`),r.length&&!m&&(y+="padding-bottom: 0;padding-top: 0;border: 0;"),y.length&&(u.style=y);const D=b.type==="html"?b.data:[{nodeName:"#text",data:b.text??String(b.data)}];return{nodeName:"TH",attributes:u,childNodes:!o&&!r.length||m?h.sortable&&a?[{nodeName:"BUTTON",attributes:{class:h.filter?s.filter:s.sorter},childNodes:D}]:D:[{nodeName:"#text",data:""}]}}).filter(b=>b)}),Dt=(i,t,e,s,n,o,{classes:a,hiddenHeader:r,header:l,footer:d,format:m,sortable:b,scrollY:g,type:h,rowRender:u,tabIndex:y},{noColumnWidths:D,unhideHeader:v,renderHeader:c})=>{const M={nodeName:"TABLE",attributes:{...i},childNodes:[{nodeName:"TBODY",childNodes:e.map(({row:$,index:T})=>{const S={nodeName:"TR",attributes:{"data-index":String(T)},childNodes:$.map((E,w)=>{const k=s[w]||{type:h,format:m,sortable:!0,searchable:!0};if(k.hidden)return;const A=k.type==="html"?{nodeName:"TD",childNodes:E.data}:{nodeName:"TD",childNodes:[{nodeName:"#text",data:E.text??String(E.data)}]};if(l||d||!n.widths[w]||D||(A.attributes={style:`width: ${n.widths[w]}%;`}),k.cellClass&&(A.attributes||(A.attributes={}),A.attributes.class=k.cellClass),k.render){const N=k.render(E.data,A,T,w);if(N){if(typeof N!="string")return N;{const f=Z(`<td>${N}</td>`);f.childNodes.length===1&&["#text","#comment"].includes(f.childNodes[0].nodeName)?A.childNodes[0].data=N:A.childNodes=f.childNodes}}}return A}).filter(E=>E)};if(T===o&&(S.attributes.class=a.cursor),u){const E=u($,S,T);if(E){if(typeof E!="string")return E;{const w=Z(`<tr>${E}</tr>`);!w.childNodes||w.childNodes.length===1&&["#text","#comment"].includes(w.childNodes[0].nodeName)?S.childNodes[0].data=E:S.childNodes=w.childNodes}}}return S})}]};if(M.attributes.class=M.attributes.class?`${M.attributes.class} ${a.table}`:a.table,l||d||c){const $=mt(t,s,n,{classes:a,hiddenHeader:r,sortable:b,scrollY:g},{noColumnWidths:D,unhideHeader:v});if(l||c){const T={nodeName:"THEAD",childNodes:[$]};!g.length&&!r||v||(T.attributes={style:"height: 0px;"}),M.childNodes.unshift(T)}if(d){const T={nodeName:"TFOOT",childNodes:[l?structuredClone($):$]};!g.length&&!r||v||(T.attributes={style:"height: 0px;"}),M.childNodes.push(T)}}return y!==!1&&(M.attributes.tabindex=String(y)),M};var gt={};({get exports(){return gt},set exports(i){gt=i}}).exports=function(){var i=1e3,t=6e4,e=36e5,s="millisecond",n="second",o="minute",a="hour",r="day",l="week",d="month",m="quarter",b="year",g="date",h="Invalid Date",u=/^(\d{4})[-/]?(\d{1,2})?[-/]?(\d{0,2})[Tt\s]*(\d{1,2})?:?(\d{1,2})?:?(\d{1,2})?[.:]?(\d+)?$/,y=/\[([^\]]+)]|Y{1,4}|M{1,4}|D{1,2}|d{1,4}|H{1,2}|h{1,2}|a|A|m{1,2}|s{1,2}|Z{1,2}|SSS/g,D={name:"en",weekdays:"Sunday_Monday_Tuesday_Wednesday_Thursday_Friday_Saturday".split("_"),months:"January_February_March_April_May_June_July_August_September_October_November_December".split("_"),ordinal:function(N){var f=["th","st","nd","rd"],p=N%100;return"["+N+(f[(p-20)%10]||f[p]||f[0])+"]"}},v=function(N,f,p){var x=String(N);return!x||x.length>=f?N:""+Array(f+1-x.length).join(p)+N},c={s:v,z:function(N){var f=-N.utcOffset(),p=Math.abs(f),x=Math.floor(p/60),_=p%60;return(f<=0?"+":"-")+v(x,2,"0")+":"+v(_,2,"0")},m:function N(f,p){if(f.date()<p.date())return-N(p,f);var x=12*(p.year()-f.year())+(p.month()-f.month()),_=f.clone().add(x,d),O=p-_<0,V=f.clone().add(x+(O?-1:1),d);return+(-(x+(p-_)/(O?_-V:V-_))||0)},a:function(N){return N<0?Math.ceil(N)||0:Math.floor(N)},p:function(N){return{M:d,y:b,w:l,d:r,D:g,h:a,m:o,s:n,ms:s,Q:m}[N]||String(N||"").toLowerCase().replace(/s$/,"")},u:function(N){return N===void 0}},M="en",$={};$[M]=D;var T=function(N){return N instanceof k},S=function N(f,p,x){var _;if(!f)return M;if(typeof f=="string"){var O=f.toLowerCase();$[O]&&(_=O),p&&($[O]=p,_=O);var V=f.split("-");if(!_&&V.length>1)return N(V[0])}else{var L=f.name;$[L]=f,_=L}return!x&&_&&(M=_),_||!x&&M},E=function(N,f){if(T(N))return N.clone();var p=typeof f=="object"?f:{};return p.date=N,p.args=arguments,new k(p)},w=c;w.l=S,w.i=T,w.w=function(N,f){return E(N,{locale:f.$L,utc:f.$u,x:f.$x,$offset:f.$offset})};var k=function(){function N(p){this.$L=S(p.locale,null,!0),this.parse(p)}var f=N.prototype;return f.parse=function(p){this.$d=function(x){var _=x.date,O=x.utc;if(_===null)return new Date(NaN);if(w.u(_))return new Date;if(_ instanceof Date)return new Date(_);if(typeof _=="string"&&!/Z$/i.test(_)){var V=_.match(u);if(V){var L=V[2]-1||0,P=(V[7]||"0").substring(0,3);return O?new Date(Date.UTC(V[1],L,V[3]||1,V[4]||0,V[5]||0,V[6]||0,P)):new Date(V[1],L,V[3]||1,V[4]||0,V[5]||0,V[6]||0,P)}}return new Date(_)}(p),this.$x=p.x||{},this.init()},f.init=function(){var p=this.$d;this.$y=p.getFullYear(),this.$M=p.getMonth(),this.$D=p.getDate(),this.$W=p.getDay(),this.$H=p.getHours(),this.$m=p.getMinutes(),this.$s=p.getSeconds(),this.$ms=p.getMilliseconds()},f.$utils=function(){return w},f.isValid=function(){return this.$d.toString()!==h},f.isSame=function(p,x){var _=E(p);return this.startOf(x)<=_&&_<=this.endOf(x)},f.isAfter=function(p,x){return E(p)<this.startOf(x)},f.isBefore=function(p,x){return this.endOf(x)<E(p)},f.$g=function(p,x,_){return w.u(p)?this[x]:this.set(_,p)},f.unix=function(){return Math.floor(this.valueOf()/1e3)},f.valueOf=function(){return this.$d.getTime()},f.startOf=function(p,x){var _=this,O=!!w.u(x)||x,V=w.p(p),L=function(F,I){var j=w.w(_.$u?Date.UTC(_.$y,I,F):new Date(_.$y,I,F),_);return O?j:j.endOf(r)},P=function(F,I){return w.w(_.toDate()[F].apply(_.toDate("s"),(O?[0,0,0,0]:[23,59,59,999]).slice(I)),_)},C=this.$W,Y=this.$M,q=this.$D,B="set"+(this.$u?"UTC":"");switch(V){case b:return O?L(1,0):L(31,11);case d:return O?L(1,Y):L(0,Y+1);case l:var G=this.$locale().weekStart||0,W=(C<G?C+7:C)-G;return L(O?q-W:q+(6-W),Y);case r:case g:return P(B+"Hours",0);case a:return P(B+"Minutes",1);case o:return P(B+"Seconds",2);case n:return P(B+"Milliseconds",3);default:return this.clone()}},f.endOf=function(p){return this.startOf(p,!1)},f.$set=function(p,x){var _,O=w.p(p),V="set"+(this.$u?"UTC":""),L=(_={},_[r]=V+"Date",_[g]=V+"Date",_[d]=V+"Month",_[b]=V+"FullYear",_[a]=V+"Hours",_[o]=V+"Minutes",_[n]=V+"Seconds",_[s]=V+"Milliseconds",_)[O],P=O===r?this.$D+(x-this.$W):x;if(O===d||O===b){var C=this.clone().set(g,1);C.$d[L](P),C.init(),this.$d=C.set(g,Math.min(this.$D,C.daysInMonth())).$d}else L&&this.$d[L](P);return this.init(),this},f.set=function(p,x){return this.clone().$set(p,x)},f.get=function(p){return this[w.p(p)]()},f.add=function(p,x){var _,O=this;p=Number(p);var V=w.p(x),L=function(Y){var q=E(O);return w.w(q.date(q.date()+Math.round(Y*p)),O)};if(V===d)return this.set(d,this.$M+p);if(V===b)return this.set(b,this.$y+p);if(V===r)return L(1);if(V===l)return L(7);var P=(_={},_[o]=t,_[a]=e,_[n]=i,_)[V]||1,C=this.$d.getTime()+p*P;return w.w(C,this)},f.subtract=function(p,x){return this.add(-1*p,x)},f.format=function(p){var x=this,_=this.$locale();if(!this.isValid())return _.invalidDate||h;var O=p||"YYYY-MM-DDTHH:mm:ssZ",V=w.z(this),L=this.$H,P=this.$m,C=this.$M,Y=_.weekdays,q=_.months,B=function(I,j,U,J){return I&&(I[j]||I(x,O))||U[j].slice(0,J)},G=function(I){return w.s(L%12||12,I,"0")},W=_.meridiem||function(I,j,U){var J=I<12?"AM":"PM";return U?J.toLowerCase():J},F={YY:String(this.$y).slice(-2),YYYY:this.$y,M:C+1,MM:w.s(C+1,2,"0"),MMM:B(_.monthsShort,C,q,3),MMMM:B(q,C),D:this.$D,DD:w.s(this.$D,2,"0"),d:String(this.$W),dd:B(_.weekdaysMin,this.$W,Y,2),ddd:B(_.weekdaysShort,this.$W,Y,3),dddd:Y[this.$W],H:String(L),HH:w.s(L,2,"0"),h:G(1),hh:G(2),a:W(L,P,!0),A:W(L,P,!1),m:String(P),mm:w.s(P,2,"0"),s:String(this.$s),ss:w.s(this.$s,2,"0"),SSS:w.s(this.$ms,3,"0"),Z:V};return O.replace(y,function(I,j){return j||F[I]||V.replace(":","")})},f.utcOffset=function(){return 15*-Math.round(this.$d.getTimezoneOffset()/15)},f.diff=function(p,x,_){var O,V=w.p(x),L=E(p),P=(L.utcOffset()-this.utcOffset())*t,C=this-L,Y=w.m(this,L);return Y=(O={},O[b]=Y/12,O[d]=Y,O[m]=Y/3,O[l]=(C-P)/6048e5,O[r]=(C-P)/864e5,O[a]=C/e,O[o]=C/t,O[n]=C/i,O)[V]||C,_?Y:w.a(Y)},f.daysInMonth=function(){return this.endOf(d).$D},f.$locale=function(){return $[this.$L]},f.locale=function(p,x){if(!p)return this.$L;var _=this.clone(),O=S(p,x,!0);return O&&(_.$L=O),_},f.clone=function(){return w.w(this.$d,this)},f.toDate=function(){return new Date(this.valueOf())},f.toJSON=function(){return this.isValid()?this.toISOString():null},f.toISOString=function(){return this.$d.toISOString()},f.toString=function(){return this.$d.toUTCString()},N}(),A=k.prototype;return E.prototype=A,[["$ms",s],["$s",n],["$m",o],["$H",a],["$W",r],["$M",d],["$y",b],["$D",g]].forEach(function(N){A[N[1]]=function(f){return this.$g(f,N[0],N[1])}}),E.extend=function(N,f){return N.$i||(N(f,k,E),N.$i=!0),E},E.locale=S,E.isDayjs=T,E.unix=function(N){return E(1e3*N)},E.en=$[M],E.Ls=$,E.p={},E}();var et=gt,_t={};({get exports(){return _t},set exports(i){_t=i}}).exports=function(){var i={LTS:"h:mm:ss A",LT:"h:mm A",L:"MM/DD/YYYY",LL:"MMMM D, YYYY",LLL:"MMMM D, YYYY h:mm A",LLLL:"dddd, MMMM D, YYYY h:mm A"},t=/(\[[^[]*\])|([-_:/.,()\s]+)|(A|a|YYYY|YY?|MM?M?M?|Do|DD?|hh?|HH?|mm?|ss?|S{1,3}|z|ZZ?)/g,e=/\d\d/,s=/\d\d?/,n=/\d*[^-_:/,()\s\d]+/,o={},a=function(h){return(h=+h)+(h>68?1900:2e3)},r=function(h){return function(u){this[h]=+u}},l=[/[+-]\d\d:?(\d\d)?|Z/,function(h){(this.zone||(this.zone={})).offset=function(u){if(!u||u==="Z")return 0;var y=u.match(/([+-]|\d\d)/g),D=60*y[1]+(+y[2]||0);return D===0?0:y[0]==="+"?-D:D}(h)}],d=function(h){var u=o[h];return u&&(u.indexOf?u:u.s.concat(u.f))},m=function(h,u){var y,D=o.meridiem;if(D){for(var v=1;v<=24;v+=1)if(h.indexOf(D(v,0,u))>-1){y=v>12;break}}else y=h===(u?"pm":"PM");return y},b={A:[n,function(h){this.afternoon=m(h,!1)}],a:[n,function(h){this.afternoon=m(h,!0)}],S:[/\d/,function(h){this.milliseconds=100*+h}],SS:[e,function(h){this.milliseconds=10*+h}],SSS:[/\d{3}/,function(h){this.milliseconds=+h}],s:[s,r("seconds")],ss:[s,r("seconds")],m:[s,r("minutes")],mm:[s,r("minutes")],H:[s,r("hours")],h:[s,r("hours")],HH:[s,r("hours")],hh:[s,r("hours")],D:[s,r("day")],DD:[e,r("day")],Do:[n,function(h){var u=o.ordinal,y=h.match(/\d+/);if(this.day=y[0],u)for(var D=1;D<=31;D+=1)u(D).replace(/\[|\]/g,"")===h&&(this.day=D)}],M:[s,r("month")],MM:[e,r("month")],MMM:[n,function(h){var u=d("months"),y=(d("monthsShort")||u.map(function(D){return D.slice(0,3)})).indexOf(h)+1;if(y<1)throw new Error;this.month=y%12||y}],MMMM:[n,function(h){var u=d("months").indexOf(h)+1;if(u<1)throw new Error;this.month=u%12||u}],Y:[/[+-]?\d+/,r("year")],YY:[e,function(h){this.year=a(h)}],YYYY:[/\d{4}/,r("year")],Z:l,ZZ:l};function g(h){var u,y;u=h,y=o&&o.formats;for(var D=(h=u.replace(/(\[[^\]]+])|(LTS?|l{1,4}|L{1,4})/g,function(E,w,k){var A=k&&k.toUpperCase();return w||y[k]||i[k]||y[A].replace(/(\[[^\]]+])|(MMMM|MM|DD|dddd)/g,function(N,f,p){return f||p.slice(1)})})).match(t),v=D.length,c=0;c<v;c+=1){var M=D[c],$=b[M],T=$&&$[0],S=$&&$[1];D[c]=S?{regex:T,parser:S}:M.replace(/^\[|\]$/g,"")}return function(E){for(var w={},k=0,A=0;k<v;k+=1){var N=D[k];if(typeof N=="string")A+=N.length;else{var f=N.regex,p=N.parser,x=E.slice(A),_=f.exec(x)[0];p.call(w,_),E=E.replace(_,"")}}return function(O){var V=O.afternoon;if(V!==void 0){var L=O.hours;V?L<12&&(O.hours+=12):L===12&&(O.hours=0),delete O.afternoon}}(w),w}}return function(h,u,y){y.p.customParseFormat=!0,h&&h.parseTwoDigitYear&&(a=h.parseTwoDigitYear);var D=u.prototype,v=D.parse;D.parse=function(c){var M=c.date,$=c.utc,T=c.args;this.$u=$;var S=T[1];if(typeof S=="string"){var E=T[2]===!0,w=T[3]===!0,k=E||w,A=T[2];w&&(A=T[2]),o=this.$locale(),!E&&A&&(o=y.Ls[A]),this.$d=function(x,_,O){try{if(["x","X"].indexOf(_)>-1)return new Date((_==="X"?1e3:1)*x);var V=g(_)(x),L=V.year,P=V.month,C=V.day,Y=V.hours,q=V.minutes,B=V.seconds,G=V.milliseconds,W=V.zone,F=new Date,I=C||(L||P?1:F.getDate()),j=L||F.getFullYear(),U=0;L&&!P||(U=P>0?P-1:F.getMonth());var J=Y||0,ot=q||0,rt=B||0,lt=G||0;return W?new Date(Date.UTC(j,U,I,J,ot,rt,lt+60*W.offset*1e3)):O?new Date(Date.UTC(j,U,I,J,ot,rt,lt)):new Date(j,U,I,J,ot,rt,lt)}catch{return new Date("")}}(M,S,$),this.init(),A&&A!==!0&&(this.$L=this.locale(A).$L),k&&M!=this.format(S)&&(this.$d=new Date("")),o={}}else if(S instanceof Array)for(var N=S.length,f=1;f<=N;f+=1){T[1]=S[f-1];var p=y.apply(this,T);if(p.isValid()){this.$d=p.$d,this.$L=p.$L,this.init();break}f===N&&(this.$d=new Date(""))}else v.call(this,c)}}}();var It=_t;et.extend(It);const Ot=(i,t)=>{let e;if(t)switch(t){case"ISO_8601":e=i;break;case"RFC_2822":e=et(i.slice(5),"DD MMM YYYY HH:mm:ss ZZ").unix();break;case"MYSQL":e=et(i,"YYYY-MM-DD hh:mm:ss").unix();break;case"UNIX":e=et(i).unix();break;default:e=et(i,t,!0).valueOf()}return e},X=(i,t)=>{if(i?.constructor===Object&&Object.prototype.hasOwnProperty.call(i,"data")&&!Object.keys(i).find(s=>!["text","order","data"].includes(s)))return i;const e={data:i};switch(t.type){case"string":typeof i!="string"&&(e.text=String(e.data),e.order=e.text);break;case"date":t.format&&(e.order=Ot(String(e.data),t.format));break;case"number":e.text=String(e.data),e.data=parseInt(e.data,10);break;case"html":{const s=Array.isArray(e.data)?{nodeName:"TD",childNodes:e.data}:Z(`<td>${String(e.data)}</td>`);e.data=s.childNodes||[];const n=at(s);e.text=n,e.order=n;break}case"boolean":typeof e.data=="string"&&(e.data=e.data.toLowerCase().trim()),e.data=!["false",!1,null,void 0,0].includes(e.data),e.order=e.data?1:0,e.text=String(e.data);break;case"other":e.text="",e.order=0;break;default:e.text=JSON.stringify(e.data)}return e},st=i=>{if(i instanceof Object&&i.constructor===Object&&i.hasOwnProperty("data")&&(typeof i.text=="string"||typeof i.data=="string"))return i;const t={data:i};if(typeof i=="string"){if(i.length){const e=Z(`<th>${i}</th>`);if(e.childNodes&&(e.childNodes.length!==1||e.childNodes[0].nodeName!=="#text")){t.data=e.childNodes,t.type="html";const s=at(e);t.text=s}}}else[null,void 0].includes(i)?t.text="":t.text=JSON.stringify(i);return t},Mt=(i,t,e,s,n)=>{const o={data:[],headings:[]};i.headings?o.headings=i.headings.map(a=>st(a)):t?.tHead?o.headings=Array.from(t.tHead.querySelectorAll("th")).map((a,r)=>{const l=(m=>{const b=Q(m,{valueDiffing:!1});let g;return g=!b.childNodes||b.childNodes.length===1&&b.childNodes[0].nodeName==="#text"?{data:m.innerText,type:"string"}:{data:b.childNodes,type:"html",text:at(b)},g})(a);e[r]||(e[r]={type:s,format:n,searchable:!0,sortable:!0});const d=e[r];return a.dataset.sortable?.trim().toLowerCase()!=="false"&&a.dataset.sort?.trim().toLowerCase()!=="false"||(d.sortable=!1),a.dataset.searchable?.trim().toLowerCase()==="false"&&(d.searchable=!1),a.dataset.hidden?.trim().toLowerCase()!=="true"&&a.getAttribute("hidden")?.trim().toLowerCase()!=="true"||(d.hidden=!0),["number","string","html","date","boolean","other"].includes(a.dataset.type)&&(d.type=a.dataset.type,d.type==="date"&&a.dataset.format&&(d.format=a.dataset.format)),l}):i.data?.length?o.headings=i.data[0].map(a=>st("")):t?.tBodies.length&&(o.headings=Array.from(t.tBodies[0].rows[0].cells).map(a=>st("")));for(let a=0;a<o.headings.length;a++)e[a]||(e[a]={type:s,format:n,sortable:!0,searchable:!0});if(i.data?o.data=i.data.map(a=>a.map((r,l)=>X(r,e[l]))):t?.tBodies?.length&&(o.data=Array.from(t.tBodies[0].rows).map(a=>Array.from(a.cells).map((r,l)=>{const d=r.dataset.content?X(r.dataset.content,e[l]):((m,b)=>{let g;switch(b.type){case"string":g={data:m.innerText};break;case"date":{const h=m.innerText;g={data:h,order:Ot(h,b.format)};break}case"number":g={data:parseInt(m.innerText,10),text:m.innerText};break;case"boolean":{const h=!["false","0","null","undefined"].includes(m.innerText.toLowerCase().trim());g={data:h,order:h?1:0,text:h?"1":"0"};break}default:g={data:Q(m,{valueDiffing:!1}).childNodes||[],text:m.innerText,order:m.innerText}}return g})(r,e[l]);return r.dataset.order&&(d.order=isNaN(parseFloat(r.dataset.order))?r.dataset.order:parseFloat(r.dataset.order)),d}))),o.data.length&&o.data[0].length!==o.headings.length)throw new Error("Data heading length mismatch.");return o};class Rt{constructor(t){this.dt=t,this.cursor=!1}setCursor(t=!1){if(t===this.cursor)return;const e=this.cursor;if(this.cursor=t,this.dt._renderTable(),t!==!1&&this.dt.options.scrollY){const s=this.dt.dom.querySelector(`tr.${this.dt.options.classes.cursor}`);s&&s.scrollIntoView({block:"nearest"})}this.dt.emit("datatable.cursormove",this.cursor,e)}add(t){const e=t.map((s,n)=>{const o=this.dt.columns.settings[n];return X(s,o)});this.dt.data.data.push(e),this.dt.data.data.length&&(this.dt.hasRows=!0),this.dt.update(!0)}remove(t){if(!Array.isArray(t))return this.remove([t]);this.dt.data.data=this.dt.data.data.filter((e,s)=>!t.includes(s)),this.dt.data.data.length||(this.dt.hasRows=!1),this.dt.update(!0)}findRowIndex(t,e){return this.dt.data.data.findIndex(s=>(s[t].text??String(s[t].data)).toLowerCase().includes(String(e).toLowerCase()))}findRow(t,e){const s=this.findRowIndex(t,e);if(s<0)return{index:-1,row:null,cols:[]};const n=this.dt.data.data[s],o=n.map(a=>a.data);return{index:s,row:n,cols:o}}updateRow(t,e){const s=e.map((n,o)=>{const a=this.dt.columns.settings[o];return X(n,a)});this.dt.data.data.splice(t,1,s),this.dt.update(!0)}}class jt{constructor(t){this.dt=t,this.init()}init(){[this.settings,this._state]=((t=[],e,s)=>{let n=[],o=!1;const a=[];return t.forEach(r=>{(Array.isArray(r.select)?r.select:[r.select]).forEach(l=>{n[l]||(n[l]={type:r.type||e,sortable:!0,searchable:!0});const d=n[l];r.render&&(d.render=r.render),r.format?d.format=r.format:r.type==="date"&&(d.format=s),r.cellClass&&(d.cellClass=r.cellClass),r.headerClass&&(d.headerClass=r.headerClass),r.locale&&(d.locale=r.locale),r.sortable===!1?d.sortable=!1:(r.numeric&&(d.numeric=r.numeric),r.caseFirst&&(d.caseFirst=r.caseFirst)),r.searchable===!1?d.searchable=!1:r.sensitivity&&(d.sensitivity=r.sensitivity),(d.searchable||d.sortable)&&r.ignorePunctuation!==void 0&&(d.ignorePunctuation=r.ignorePunctuation),r.hidden&&(d.hidden=!0),r.filter&&(d.filter=r.filter),r.sortSequence&&(d.sortSequence=r.sortSequence),r.sort&&(r.filter?a[l]=r.sort:o={column:l,dir:r.sort}),r.searchItemSeparator!==void 0&&(d.searchItemSeparator=r.searchItemSeparator)})}),n=n.map(r=>r||{type:e,format:e==="date"?s:void 0,sortable:!0,searchable:!0}),[n,{filters:a,sort:o,widths:[]}]})(this.dt.options.columns,this.dt.options.type,this.dt.options.format)}swap(t){if(t.length===2){const e=this.dt.data.headings.map((a,r)=>r),s=t[0],n=t[1],o=e[n];return e[n]=e[s],e[s]=o,this.order(e)}}order(t){this.dt.data.headings=t.map(e=>this.dt.data.headings[e]),this.dt.data.data=this.dt.data.data.map(e=>t.map(s=>e[s])),this.settings=t.map(e=>this.settings[e]),this.dt.update()}hide(t){t.length&&(t.forEach(e=>{this.settings[e]||(this.settings[e]={type:"string"}),this.settings[e].hidden=!0}),this.dt.update())}show(t){t.length&&(t.forEach(e=>{this.settings[e]||(this.settings[e]={type:"string",sortable:!0}),delete this.settings[e].hidden}),this.dt.update())}visible(t){return t===void 0&&(t=[...Array(this.dt.data.headings.length).keys()]),Array.isArray(t)?t.map(e=>!this.settings[e]?.hidden):!this.settings[t]?.hidden}add(t){const e=this.dt.data.headings.length;if(this.dt.data.headings=this.dt.data.headings.concat([st(t.heading)]),this.dt.data.data=this.dt.data.data.map((s,n)=>s.concat([X(t.data[n],t)])),this.settings[e]={type:t.type||"string",sortable:!0,searchable:!0},t.type||t.format||t.sortable||t.render||t.filter){const s=this.settings[e];t.render&&(s.render=t.render),t.format&&(s.format=t.format),t.cellClass&&(s.cellClass=t.cellClass),t.headerClass&&(s.headerClass=t.headerClass),t.locale&&(s.locale=t.locale),t.sortable===!1?s.sortable=!1:(t.numeric&&(s.numeric=t.numeric),t.caseFirst&&(s.caseFirst=t.caseFirst)),t.searchable===!1?s.searchable=!1:t.sensitivity&&(s.sensitivity=t.sensitivity),(s.searchable||s.sortable)&&t.ignorePunctuation&&(s.ignorePunctuation=t.ignorePunctuation),t.hidden&&(s.hidden=!0),t.filter&&(s.filter=t.filter),t.sortSequence&&(s.sortSequence=t.sortSequence)}this.dt.update(!0)}remove(t){if(!Array.isArray(t))return this.remove([t]);this.dt.data.headings=this.dt.data.headings.filter((e,s)=>!t.includes(s)),this.dt.data.data=this.dt.data.data.map(e=>e.filter((s,n)=>!t.includes(n))),this.dt.update(!0)}filter(t,e=!1){if(!this.settings[t]?.filter?.length)return;const s=this._state.filters[t];let n;if(s){let o=!1;n=this.settings[t].filter.find(a=>!!o||(a===s&&(o=!0),!1))}else{const o=this.settings[t].filter;n=o?o[0]:void 0}n?this._state.filters[t]=n:s&&(this._state.filters[t]=void 0),this.dt._currentPage=1,this.dt.update(),e||this.dt.emit("datatable.filter",t,n)}sort(t,e,s=!1){const n=this.settings[t];if(s||this.dt.emit("datatable.sorting",t,e),!e){const a=!(!this._state.sort||this._state.sort.column!==t)&&this._state.sort?.dir,r=n?.sortSequence||["asc","desc"];if(a){const l=r.indexOf(a);e=l===-1?r[0]||"asc":l===r.length-1?r[0]:r[l+1]}else e=r.length?r[0]:"asc"}const o=!!["string","html"].includes(n.type)&&new Intl.Collator(n.locale||this.dt.options.locale,{usage:"sort",numeric:n.numeric||this.dt.options.numeric,caseFirst:n.caseFirst||this.dt.options.caseFirst,ignorePunctuation:n.ignorePunctuation||this.dt.options.ignorePunctuation});this.dt.data.data.sort((a,r)=>{let l=a[t].order||a[t].data,d=r[t].order||r[t].data;if(e==="desc"){const m=l;l=d,d=m}return o?o.compare(String(l),String(d)):l<d?-1:l>d?1:0}),this._state.sort={column:t,dir:e},this.dt._searchQueries.length?(this.dt.multiSearch(this.dt._searchQueries),this.dt.emit("datatable.sort",t,e)):s||(this.dt._currentPage=1,this.dt.update(),this.dt.emit("datatable.sort",t,e))}_measureWidths(){const t=this.dt.data.headings.filter((e,s)=>!this.settings[s]?.hidden);if((this.dt.options.scrollY.length||this.dt.options.fixedColumns)&&t?.length){this._state.widths=[];const e={noPaging:!0};if(this.dt.options.header||this.dt.options.footer){this.dt.options.scrollY.length&&(e.unhideHeader=!0),this.dt.headerDOM&&this.dt.headerDOM.parentElement.removeChild(this.dt.headerDOM),e.noColumnWidths=!0,this.dt._renderTable(e);const s=Array.from(this.dt.dom.querySelector("thead, tfoot")?.firstElementChild?.querySelectorAll("th")||[]);let n=0;const o=this.dt.data.headings.map((r,l)=>{if(this.settings[l]?.hidden)return 0;const d=s[n].offsetWidth;return n+=1,d}),a=o.reduce((r,l)=>r+l,0);this._state.widths=o.map(r=>r/a*100)}else{e.renderHeader=!0,this.dt._renderTable(e);const s=Array.from(this.dt.dom.querySelector("thead, tfoot")?.firstElementChild?.querySelectorAll("th")||[]);let n=0;const o=this.dt.data.headings.map((r,l)=>{if(this.settings[l]?.hidden)return 0;const d=s[n].offsetWidth;return n+=1,d}),a=o.reduce((r,l)=>r+l,0);this._state.widths=o.map(r=>r/a*100)}this.dt._renderTable()}}}const nt={sortable:!0,locale:"en",numeric:!0,caseFirst:"false",searchable:!0,sensitivity:"base",ignorePunctuation:!0,destroyable:!0,searchItemSeparator:"",searchQuerySeparator:" ",searchAnd:!1,data:{},type:"html",format:"YYYY-MM-DD",columns:[],paging:!0,perPage:10,perPageSelect:[5,10,15,20,25],nextPrev:!0,firstLast:!1,prevText:"‹",nextText:"›",firstText:"«",lastText:"»",ellipsisText:"…",truncatePager:!0,pagerDelta:2,scrollY:"",fixedColumns:!0,fixedHeight:!1,footer:!1,header:!0,hiddenHeader:!1,rowNavigation:!1,tabIndex:!1,pagerRender:!1,rowRender:!1,tableRender:!1,diffDomOptions:{valueDiffing:!1},labels:{placeholder:"Search...",searchTitle:"Search within table",perPage:"entries per page",pageTitle:"Page {page}",noRows:"No entries found",noResults:"No results match your search query",info:"Showing {start} to {end} of {rows} entries"},template:(i,t)=>`<div class='${i.classes.top}'>
    ${i.paging&&i.perPageSelect?`<div class='${i.classes.dropdown}'>
            <label>
                <select class='${i.classes.selector}'></select> ${i.labels.perPage}
            </label>
        </div>`:""}
    ${i.searchable?`<div class='${i.classes.search}'>
            <input class='${i.classes.input}' placeholder='${i.labels.placeholder}' type='search' title='${i.labels.searchTitle}'${t.id?` aria-controls="${t.id}"`:""}>
        </div>`:""}
</div>
<div class='${i.classes.container}'${i.scrollY.length?` style='height: ${i.scrollY}; overflow-Y: auto;'`:""}></div>
<div class='${i.classes.bottom}'>
    ${i.paging?`<div class='${i.classes.info}'></div>`:""}
    <nav class='${i.classes.pagination}'></nav>
</div>`,classes:{active:"datatable-active",ascending:"datatable-ascending",bottom:"datatable-bottom",container:"datatable-container",cursor:"datatable-cursor",descending:"datatable-descending",disabled:"datatable-disabled",dropdown:"datatable-dropdown",ellipsis:"datatable-ellipsis",filter:"datatable-filter",filterActive:"datatable-filter-active",empty:"datatable-empty",headercontainer:"datatable-headercontainer",hidden:"datatable-hidden",info:"datatable-info",input:"datatable-input",loading:"datatable-loading",pagination:"datatable-pagination",paginationList:"datatable-pagination-list",paginationListItem:"datatable-pagination-list-item",paginationListItemLink:"datatable-pagination-list-item-link",search:"datatable-search",selector:"datatable-selector",sorter:"datatable-sorter",table:"datatable-table",top:"datatable-top",wrapper:"datatable-wrapper"}},tt=(i,t,e,s={})=>({nodeName:"LI",attributes:{class:s.active&&!s.hidden?`${e.classes.paginationListItem} ${e.classes.active}`:s.hidden?`${e.classes.paginationListItem} ${e.classes.hidden} ${e.classes.disabled}`:e.classes.paginationListItem},childNodes:[{nodeName:"BUTTON",attributes:{"data-page":String(i),class:e.classes.paginationListItemLink,"aria-label":e.labels.pageTitle.replace("{page}",String(i))},childNodes:[{nodeName:"#text",data:t}]}]}),Bt=(i,t,e,s,n)=>{let o=[];if(n.firstLast&&o.push(tt(1,n.firstText,n)),n.nextPrev){const r=i?1:e-1;o.push(tt(r,n.prevText,n,{hidden:i}))}let a=[...Array(s).keys()].map(r=>tt(r+1,String(r+1),n,{active:r===e-1}));if(n.truncatePager&&(a=((r,l,d,m)=>{const b=m.pagerDelta,g=m.classes,h=m.ellipsisText,u=2*b;let y=l-b,D=l+b;l<4-b+u?D=3+u:l>d-(3-b+u)&&(y=d-(2+u));const v=[];for(let $=1;$<=d;$++)if($==1||$==d||$>=y&&$<=D){const T=r[$-1];v.push(T)}let c;const M=[];return v.forEach($=>{const T=parseInt($.childNodes[0].attributes["data-page"],10);if(c){const S=parseInt(c.childNodes[0].attributes["data-page"],10);if(T-S==2)M.push(r[S]);else if(T-S!=1){const E={nodeName:"LI",attributes:{class:`${g.paginationListItem} ${g.ellipsis} ${g.disabled}`},childNodes:[{nodeName:"BUTTON",attributes:{class:g.paginationListItemLink},childNodes:[{nodeName:"#text",data:h}]}]};M.push(E)}}M.push($),c=$}),M})(a,e,s,n)),o=o.concat(a),n.nextPrev){const r=t?s:e+1;o.push(tt(r,n.nextText,n,{hidden:t}))}return n.firstLast&&o.push(tt(s,n.lastText,n)),{nodeName:"UL",attributes:{class:n.classes.paginationList},childNodes:a.length>1?o:[]}};class qt{constructor(t,e={}){const s=typeof t=="string"?document.querySelector(t):t;s instanceof HTMLTableElement?this.dom=s:(this.dom=document.createElement("table"),s.appendChild(this.dom));const n={...nt.diffDomOptions,...e.diffDomOptions},o={...nt.labels,...e.labels},a={...nt.classes,...e.classes};this.options={...nt,...e,diffDomOptions:n,labels:o,classes:a},this._initialInnerHTML=this.options.destroyable?this.dom.innerHTML:"",this.options.tabIndex?this.dom.tabIndex=this.options.tabIndex:this.options.rowNavigation&&this.dom.tabIndex===-1&&(this.dom.tabIndex=0),this._listeners={onResize:()=>this._onResize()},this._dd=new Yt(this.options.diffDomOptions||{}),this.initialized=!1,this._events={},this._currentPage=0,this.onFirstPage=!0,this.hasHeadings=!1,this.hasRows=!1,this._searchQueries=[],this.init()}init(){if(this.initialized||this.dom.classList.contains(this.options.classes.table))return!1;this._virtualDOM=Q(this.dom,this.options.diffDomOptions||{}),this._tableAttributes={...this._virtualDOM.attributes},this.rows=new Rt(this),this.columns=new jt(this),this.data=Mt(this.options.data,this.dom,this.columns.settings,this.options.type,this.options.format),this._render(),setTimeout(()=>{this.emit("datatable.init"),this.initialized=!0},10)}_render(){this.wrapperDOM=K("div",{class:`${this.options.classes.wrapper} ${this.options.classes.loading}`}),this.wrapperDOM.innerHTML=this.options.template(this.options,this.dom);const t=this.wrapperDOM.querySelector(`select.${this.options.classes.selector}`);t&&this.options.paging&&this.options.perPageSelect?this.options.perPageSelect.forEach(e=>{const[s,n]=Array.isArray(e)?[e[0],e[1]]:[String(e),e],o=n===this.options.perPage,a=new Option(s,String(n),o,o);t.appendChild(a)}):t&&t.parentElement.removeChild(t),this.containerDOM=this.wrapperDOM.querySelector(`.${this.options.classes.container}`),this._pagerDOMs=[],Array.from(this.wrapperDOM.querySelectorAll(`.${this.options.classes.pagination}`)).forEach(e=>{e instanceof HTMLElement&&(e.innerHTML=`<ul class="${this.options.classes.paginationList}"></ul>`,this._pagerDOMs.push(e.firstElementChild))}),this._virtualPagerDOM={nodeName:"UL",attributes:{class:this.options.classes.paginationList}},this._label=this.wrapperDOM.querySelector(`.${this.options.classes.info}`),this.dom.parentElement.replaceChild(this.wrapperDOM,this.dom),this.containerDOM.appendChild(this.dom),this._rect=this.dom.getBoundingClientRect(),this._fixHeight(),this.options.header||this.wrapperDOM.classList.add("no-header"),this.options.footer||this.wrapperDOM.classList.add("no-footer"),this.options.sortable&&this.wrapperDOM.classList.add("sortable"),this.options.searchable&&this.wrapperDOM.classList.add("searchable"),this.options.fixedHeight&&this.wrapperDOM.classList.add("fixed-height"),this.options.fixedColumns&&this.wrapperDOM.classList.add("fixed-columns"),this._bindEvents(),this.columns._state.sort&&this.columns.sort(this.columns._state.sort.column,this.columns._state.sort.dir,!0),this.update(!0)}_renderTable(t={}){let e=Dt(this._tableAttributes,this.data.headings,(this.options.paging||this._searchQueries.length||this.columns._state.filters.length)&&this._currentPage&&this.pages.length&&!t.noPaging?this.pages[this._currentPage-1]:this.data.data.map((n,o)=>({row:n,index:o})),this.columns.settings,this.columns._state,this.rows.cursor,this.options,t);if(this.options.tableRender){const n=this.options.tableRender(this.data,e,"main");n&&(e=n)}const s=this._dd.diff(this._virtualDOM,e);this._dd.apply(this.dom,s),this._virtualDOM=e}_renderPage(t=!1){this.hasRows&&this.totalPages?(this._currentPage>this.totalPages&&(this._currentPage=1),this._renderTable(),this.onFirstPage=this._currentPage===1,this.onLastPage=this._currentPage===this.lastPage):this.setMessage(this.options.labels.noRows);let e,s=0,n=0,o=0;if(this.totalPages&&(s=this._currentPage-1,n=s*this.options.perPage,o=n+this.pages[s].length,n+=1,e=this._searchQueries.length?this._searchData.length:this.data.data.length),this._label&&this.options.labels.info.length){const a=this.options.labels.info.replace("{start}",String(n)).replace("{end}",String(o)).replace("{page}",String(this._currentPage)).replace("{pages}",String(this.totalPages)).replace("{rows}",String(e));this._label.innerHTML=e?a:""}if(this._currentPage==1&&this._fixHeight(),this.options.rowNavigation&&this._currentPage&&(!this.rows.cursor||!this.pages[this._currentPage-1].find(a=>a.index===this.rows.cursor))){const a=this.pages[this._currentPage-1];a.length&&(t?this.rows.setCursor(a[a.length-1].index):this.rows.setCursor(a[0].index))}}_renderPagers(){if(!this.options.paging)return;let t=Bt(this.onFirstPage,this.onLastPage,this._currentPage,this.totalPages,this.options);if(this.options.pagerRender){const s=this.options.pagerRender([this.onFirstPage,this.onLastPage,this._currentPage,this.totalPages],t);s&&(t=s)}const e=this._dd.diff(this._virtualPagerDOM,t);this._pagerDOMs.forEach(s=>{this._dd.apply(s,e)}),this._virtualPagerDOM=t}_renderSeparateHeader(){const t=this.dom.parentElement;this.headerDOM||(this.headerDOM=document.createElement("div"),this._virtualHeaderDOM={nodeName:"DIV"}),t.parentElement.insertBefore(this.headerDOM,t);let e={nodeName:"TABLE",attributes:this._tableAttributes,childNodes:[{nodeName:"THEAD",childNodes:[mt(this.data.headings,this.columns.settings,this.columns._state,this.options,{unhideHeader:!0})]}]};if(e.attributes.class=e.attributes.class?`${e.attributes.class} ${this.options.classes.table}`:this.options.classes.table,this.options.tableRender){const a=this.options.tableRender(this.data,e,"header");a&&(e=a)}const s={nodeName:"DIV",attributes:{class:this.options.classes.headercontainer},childNodes:[e]},n=this._dd.diff(this._virtualHeaderDOM,s);this._dd.apply(this.headerDOM,n),this._virtualHeaderDOM=s;const o=this.headerDOM.firstElementChild.clientWidth-this.dom.clientWidth;if(o){const a=structuredClone(this._virtualHeaderDOM);a.attributes.style=`padding-right: ${o}px;`;const r=this._dd.diff(this._virtualHeaderDOM,a);this._dd.apply(this.headerDOM,r),this._virtualHeaderDOM=a}t.scrollHeight>t.clientHeight&&(t.style.overflowY="scroll")}_bindEvents(){if(this.options.perPageSelect){const t=this.wrapperDOM.querySelector(`select.${this.options.classes.selector}`);t&&t instanceof HTMLSelectElement&&t.addEventListener("change",()=>{this.options.perPage=parseInt(t.value,10),this.update(),this._fixHeight(),this.emit("datatable.perpage",this.options.perPage)},!1)}this.options.searchable&&this.wrapperDOM.addEventListener("input",t=>{const e=t.target;if(!(e instanceof HTMLInputElement&&e.matches(`.${this.options.classes.input}`)))return;t.preventDefault();const s=[];if(Array.from(this.wrapperDOM.querySelectorAll(`.${this.options.classes.input}`)).filter(n=>n.value.length).forEach(n=>{const o=n.dataset.and||this.options.searchAnd,a=n.dataset.querySeparator||this.options.searchQuerySeparator?n.value.split(this.options.searchQuerySeparator):[n.value];o?a.forEach(r=>{n.dataset.columns?s.push({terms:[r],columns:JSON.parse(n.dataset.columns)}):s.push({terms:[r],columns:void 0})}):n.dataset.columns?s.push({terms:a,columns:JSON.parse(n.dataset.columns)}):s.push({terms:a,columns:void 0})}),s.length===1&&s[0].terms.length===1){const n=s[0];this.search(n.terms[0],n.columns)}else this.multiSearch(s)}),this.wrapperDOM.addEventListener("click",t=>{const e=t.target.closest("a, button");if(e){if(e.hasAttribute("data-page"))this.page(parseInt(e.getAttribute("data-page"),10)),t.preventDefault();else if(e.classList.contains(this.options.classes.sorter)){const s=Array.from(e.parentElement.parentElement.children).indexOf(e.parentElement),n=vt(s,this.columns.settings);this.columns.sort(n),t.preventDefault()}else if(e.classList.contains(this.options.classes.filter)){const s=Array.from(e.parentElement.parentElement.children).indexOf(e.parentElement),n=vt(s,this.columns.settings);this.columns.filter(n),t.preventDefault()}}},!1),this.options.rowNavigation?(this.dom.addEventListener("keydown",t=>{if(t.key==="ArrowUp"){let e;t.preventDefault(),t.stopPropagation(),this.pages[this._currentPage-1].find(s=>s.index===this.rows.cursor||(e=s,!1)),e?this.rows.setCursor(e.index):this.onFirstPage||this.page(this._currentPage-1,!0)}else if(t.key==="ArrowDown"){let e;t.preventDefault(),t.stopPropagation();const s=this.pages[this._currentPage-1].find(n=>!!e||(n.index===this.rows.cursor&&(e=!0),!1));s?this.rows.setCursor(s.index):this.onLastPage||this.page(this._currentPage+1)}else["Enter"," "].includes(t.key)&&this.emit("datatable.selectrow",this.rows.cursor,t)}),this.dom.addEventListener("mousedown",t=>{const e=t.target;if(e instanceof Element&&this.dom.matches(":focus")){const s=Array.from(this.dom.querySelectorAll("body tr")).find(n=>n.contains(e));s&&s instanceof HTMLElement&&this.emit("datatable.selectrow",parseInt(s.dataset.index,10),t)}})):this.dom.addEventListener("mousedown",t=>{const e=t.target;if(!(e instanceof Element))return;const s=Array.from(this.dom.querySelectorAll("body tr")).find(n=>n.contains(e));s&&s instanceof HTMLElement&&this.emit("datatable.selectrow",parseInt(s.dataset.index,10),t)}),window.addEventListener("resize",this._listeners.onResize)}_onResize(){this._rect=this.containerDOM.getBoundingClientRect(),this._rect.width&&this.update(!0)}destroy(){this.options.destroyable&&(this.dom.innerHTML=this._initialInnerHTML,this.dom.classList.remove(this.options.classes.table),this.wrapperDOM.parentElement&&this.wrapperDOM.parentElement.replaceChild(this.dom,this.wrapperDOM),this.initialized=!1,window.removeEventListener("resize",this._listeners.onResize))}update(t=!1){t&&(this.columns._measureWidths(),this.hasRows=!!this.data.data.length,this.hasHeadings=!!this.data.headings.length),this.wrapperDOM.classList.remove(this.options.classes.empty),this._paginate(),this._renderPage(),this._renderPagers(),this.options.scrollY.length&&this._renderSeparateHeader(),this.emit("datatable.update")}_paginate(){let t=this.data.data.map((e,s)=>({row:e,index:s}));return this._searchQueries.length&&(t=[],this._searchData.forEach(e=>t.push({index:e,row:this.data.data[e]}))),this.columns._state.filters.length&&this.columns._state.filters.forEach((e,s)=>{e&&(t=t.filter(n=>typeof e=="function"?e(n.row[s].data):(n.row[s].text??n.row[s].data)===e))}),this.options.paging&&this.options.perPage>0?this.pages=t.map((e,s)=>s%this.options.perPage==0?t.slice(s,s+this.options.perPage):null).filter(e=>e):this.pages=[t],this.totalPages=this.lastPage=this.pages.length,this._currentPage||(this._currentPage=1),this.totalPages}_fixHeight(){this.options.fixedHeight&&(this.containerDOM.style.height=null,this._rect=this.containerDOM.getBoundingClientRect(),this.containerDOM.style.height=`${this._rect.height}px`)}search(t,e){if(!t.length)return this._currentPage=1,this._searchQueries=[],this._searchData=[],this.update(),this.emit("datatable.search","",[]),this.wrapperDOM.classList.remove("search-results"),!1;this.multiSearch([{terms:[t],columns:e||void 0}]),this.emit("datatable.search",t,this._searchData)}multiSearch(t){if(!this.hasRows)return!1;this._currentPage=1,this._searchData=[];const e=t.map(n=>({columns:n.columns,terms:n.terms.map(o=>o.trim()).filter(o=>o)})).filter(n=>n.terms.length);if(this._searchQueries=e,!e.length)return this.update(),this.emit("datatable.multisearch",e,this._searchData),this.wrapperDOM.classList.remove("search-results"),!1;const s=e.map(n=>this.columns.settings.map((o,a)=>{if(o.hidden||!o.searchable||n.columns&&!n.columns.includes(a))return!1;let r=n.terms;const l=o.sensitivity||this.options.sensitivity;return["base","accent"].includes(l)&&(r=r.map(d=>d.toLowerCase())),["base","case"].includes(l)&&(r=r.map(d=>d.normalize("NFD").replace(/\p{Diacritic}/gu,""))),(o.ignorePunctuation??this.options.ignorePunctuation)&&(r=r.map(d=>d.replace(/[.,/#!$%^&*;:{}=-_`~()]/g,""))),r}));this.data.data.forEach((n,o)=>{const a=n.map((r,l)=>{let d=(r.text||String(r.data)).trim();const m=this.columns.settings[l];if(d.length){const g=m.sensitivity||this.options.sensitivity;["base","accent"].includes(g)&&(d=d.toLowerCase()),["base","case"].includes(g)&&(d=d.normalize("NFD").replace(/\p{Diacritic}/gu,"")),(m.ignorePunctuation??this.options.ignorePunctuation)&&(d=d.replace(/[.,/#!$%^&*;:{}=-_`~()]/g,""))}const b=m.searchItemSeparator||this.options.searchItemSeparator;return b?d.split(b):[d]});s.every(r=>r.find((l,d)=>!!l&&l.find(m=>a[d].find(b=>b.includes(m)))))&&this._searchData.push(o)}),this.wrapperDOM.classList.add("search-results"),this._searchData.length?this.update():(this.wrapperDOM.classList.remove("search-results"),this.setMessage(this.options.labels.noResults)),this.emit("datatable.multisearch",e,this._searchData)}page(t,e=!1){return t!==this._currentPage&&(isNaN(t)||(this._currentPage=t),!(t>this.pages.length||t<0)&&(this._renderPage(e),this._renderPagers(),void this.emit("datatable.page",t)))}insert(t){let e=[];if(Array.isArray(t)){const s=this.data.headings.map(n=>n.text??String(n.data));t.forEach((n,o)=>{const a=[];Object.entries(n).forEach(([r,l])=>{const d=s.indexOf(r);d>-1?a[d]=X(l,this.columns.settings[d]):this.hasHeadings||this.hasRows||o!==0||(a[s.length]=X(l,this.columns.settings[s.length]),s.push(r),this.data.headings.push(st(r)))}),e.push(a)})}else Et(t)&&(!t.headings||this.hasHeadings||this.hasRows?t.data&&Array.isArray(t.data)&&(e=t.data.map(s=>s.map((n,o)=>X(n,this.columns.settings[o])))):this.data=Mt(t,void 0,this.columns.settings,this.options.type,this.options.format));e.length&&e.forEach(s=>this.data.data.push(s)),this.hasHeadings=!!this.data.headings.length,this.columns._state.sort&&this.columns.sort(this.columns._state.sort.column,this.columns._state.sort.dir,!0),this.update(!0)}refresh(){this.options.searchable&&(Array.from(this.wrapperDOM.querySelectorAll(`.${this.options.classes.input}`)).forEach(t=>{t.value=""}),this._searchQueries=[]),this._currentPage=1,this.onFirstPage=!0,this.update(!0),this.emit("datatable.refresh")}print(){const t=K("table");let e=Dt(this._tableAttributes,this.data.headings,this.data.data.map((o,a)=>({row:o,index:a})),this.columns.settings,this.columns._state,!1,this.options,{noColumnWidths:!0,unhideHeader:!0});if(this.options.tableRender){const o=this.options.tableRender(this.data,e,"print");o&&(e=o)}const s=this._dd.diff({nodeName:"TABLE"},e);this._dd.apply(t,s);const n=window.open();n.document.body.appendChild(t),n.print()}setMessage(t){const e=this.data.headings.filter((o,a)=>!this.columns.settings[a]?.hidden).length||1;this.wrapperDOM.classList.add(this.options.classes.empty),this._label&&(this._label.innerHTML=""),this.totalPages=0,this._renderPagers();let s={nodeName:"TABLE",attributes:this._tableAttributes,childNodes:[{nodeName:"THEAD",childNodes:[mt(this.data.headings,this.columns.settings,this.columns._state,this.options,{})]},{nodeName:"TBODY",childNodes:[{nodeName:"TR",childNodes:[{nodeName:"TD",attributes:{class:this.options.classes.empty,colspan:String(e)},childNodes:[{nodeName:"#text",data:t}]}]}]}]};if(s.attributes.class=s.attributes.class?`${s.attributes.class} ${this.options.classes.table}`:this.options.classes.table,this.options.tableRender){const o=this.options.tableRender(this.data,s,"message");o&&(s=o)}const n=this._dd.diff(this._virtualDOM,s);this._dd.apply(this.dom,n),this._virtualDOM=s}on(t,e){this._events[t]=this._events[t]||[],this._events[t].push(e)}off(t,e){t in this._events&&this._events[t].splice(this._events[t].indexOf(e),1)}emit(t,...e){if(t in this._events)for(let s=0;s<this._events[t].length;s++)this._events[t][s](...e)}}const Ft={classes:{button:"datatable-column-filter-button",menu:"datatable-column-filter-menu",container:"datatable-column-filter-container",wrapper:"datatable-column-filter-wrapper"},labels:{button:"Filter columns within the table"},hiddenColumns:[]};class zt{constructor(t,e={}){this.dt=t,this.options={...Ft,...e}}init(){if(this.initialized)return;let t=this.dt.wrapperDOM.querySelector(`.${this.options.classes.button}`);if(!t){t=K("button",{class:this.options.classes.button,html:"▦"});const e=this.dt.wrapperDOM.querySelector(`.${this.dt.options.classes.search}`);e?e.appendChild(t):this.dt.wrapperDOM.appendChild(t),this.addedButtonDOM=!0}this.buttonDOM=t,this.containerDOM=K("div",{id:this.options.classes.container}),this.wrapperDOM=K("div",{class:this.options.classes.wrapper}),this.menuDOM=K("ul",{class:this.options.classes.menu,html:this.dt.data.headings.map((e,s)=>{const n=this.dt.columns.settings[s];return this.options.hiddenColumns.includes(s)?"":`<li data-column="${s}">
                        <input type="checkbox" value="${e.text||e.data}" ${n.hidden?"":"checked=''"}>
                        <label>
                            ${e.text||e.data}
                        </label>
                    </li>`}).join("")}),this.wrapperDOM.appendChild(this.menuDOM),this.containerDOM.appendChild(this.wrapperDOM),this._measureSpace(),this._bind(),this.initialized=!0}dismiss(){this.addedButtonDOM&&this.buttonDOM.parentElement&&this.buttonDOM.parentElement.removeChild(this.buttonDOM),document.removeEventListener("click",this.events.click)}_bind(){this.events={click:this._click.bind(this)},document.addEventListener("click",this.events.click)}_openMenu(){document.body.appendChild(this.containerDOM),this._measureSpace(),this.menuOpen=!0,this.dt.emit("columnFilter.menu.open")}_closeMenu(){this.menuOpen&&(this.menuOpen=!1,document.body.removeChild(this.containerDOM),this.dt.emit("columnFilter.menu.close"))}_measureSpace(){const t=window.scrollX||window.pageXOffset,e=window.scrollY||window.pageYOffset;this.rect=this.wrapperDOM.getBoundingClientRect(),this.limits={x:window.innerWidth+t-this.rect.width,y:window.innerHeight+e-this.rect.height}}_click(t){const e=t.target;if(e instanceof Element)if(this.event=t,this.buttonDOM.contains(e)){if(t.preventDefault(),this.menuOpen)return void this._closeMenu();this._openMenu();let s=t.pageX,n=t.pageY;s>this.limits.x&&(s-=this.rect.width),n>this.limits.y&&(n-=this.rect.height),this.wrapperDOM.style.top=`${n}px`,this.wrapperDOM.style.left=`${s}px`}else if(this.menuDOM.contains(e)){const s=e.closest(`.${this.options.classes.menu} > li`);if(!s)return;const n=s.querySelector("input[type=checkbox]");n.contains(e)||(n.checked=!n.checked);const o=Number(s.dataset.column);n.checked?this.dt.columns.show([o]):this.dt.columns.hide([o])}else this.menuOpen&&this._closeMenu()}}const Wt=function(i,t={}){const e=new zt(i,t);return i.initialized?e.init():i.on("datatable.init",()=>e.init()),e},Ut=new qt("#cards",{paging:!1});Wt(Ut);document.querySelector(".datatable-search .datatable-input").setAttribute("aria-label","Search");document.querySelector("nav.datatable-pagination").setAttribute("aria-label","Card Page");
